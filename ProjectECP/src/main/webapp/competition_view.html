<!DOCTYPE html>
<html>
<head>
  <title>Competition View</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="competition-view">
    <h2 id="compTitle"></h2>

    <h3>Rules:</h3>
    <img id="ruleImage" src="" width="400">

    <h3>Source:</h3>
    <div id="sourceContainer"></div>

    <h3>Update Source (Staff Only)</h3>
    <form action="UploadServlet" method="post" enctype="multipart/form-data">
      <input type="hidden" name="comp" id="compHidden">
      <input type="file" name="file" required>
      <button type="submit">Replace Source</button>
    </form>
  </div>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const comp = urlParams.get("comp");

    document.getElementById("compTitle").innerText = comp.toUpperCase() + " Competition";

    // Set rule image path
    document.getElementById("ruleImage").src = "competitions/" + comp + "/rule.jpg";

    // Show source dynamically
    const sourceDiv = document.getElementById("sourceContainer");
    let ext = "mp4"; // assume default mp4, can check with file extension logic

    if (ext === "mp4") {
      sourceDiv.innerHTML = `<video width="400" controls>
                                <source src="competitions/${comp}/source.mp4" type="video/mp4">
                             </video>`;
    }
    else if (ext === "pdf") {
      sourceDiv.innerHTML = `<embed src="competitions/${comp}/source.pdf" width="600" height="500">`;
    }
    else if (ext === "jpg" || ext === "png") {
      sourceDiv.innerHTML = `<img src="competitions/${comp}/source.jpg" width="400">`;
    }
    else if (ext === "mp3") {
      sourceDiv.innerHTML = `<audio controls>
                               <source src="competitions/${comp}/source.mp3" type="audio/mpeg">
                             </audio>`;
    }

    // Hidden input for upload servlet
    document.getElementById("compHidden").value = comp;
  </script>
</body>
</html>
